pipeline:
  build:
    image: ubuntu
    commands:
      - echo "this is a pr"
      - printenv
    when:
      event: [pull_request]

  trigger-test:
    when:
      branch:
        - master
        - feature/*
    image: registry.airwallex.com/alpine-curl:latest
    pull: true
    commands:
      - echo "this will run each time"
      - printenv
  run:
    image: ubuntu
    environment:
      - MY=$(echo 1)
    commands:
      - echo ${MY}
      - export ABC=123
  test:
    image: ubuntu
    commands:
      - echo $${ABC}
